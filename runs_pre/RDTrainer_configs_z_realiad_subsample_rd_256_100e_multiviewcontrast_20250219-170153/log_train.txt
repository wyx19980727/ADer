2025-02-19 17:01:53,507 - ==> Logging on master GPU: 0
2025-02-19 17:01:53,507 - ==> Running Trainer: RDTrainer
2025-02-19 17:01:53,507 - ==> Using GPU: [0] for Training
2025-02-19 17:01:53,507 - ==> Building model
2025-02-19 17:01:53,689 - Loading pretrained weights from url (https://download.pytorch.org/models/resnet18-5c106cde.pth)
2025-02-19 17:01:54,407 - 
------------------------------------ RD ------------------------------------
| module                               | #parameters or shape   | #flops       |
|:-------------------------------------|:-----------------------|:-------------|
| model                                | 27.081M                | 5.875G       |
|  net_t                               |  2.783M                |  1.838G      |
|   net_t.conv1                        |   9.408K               |   0.154G     |
|    net_t.conv1.weight                |    (64, 3, 7, 7)       |              |
|   net_t.bn1                          |   0.128K               |   2.097M     |
|    net_t.bn1.weight                  |    (64,)               |              |
|    net_t.bn1.bias                    |    (64,)               |              |
|   net_t.layer1                       |   0.148M               |   0.606G     |
|    net_t.layer1.0                    |    73.984K             |    0.303G    |
|     net_t.layer1.0.conv1             |     36.864K            |     0.151G   |
|      net_t.layer1.0.conv1.weight     |      (64, 64, 3, 3)    |              |
|     net_t.layer1.0.bn1               |     0.128K             |     0.524M   |
|      net_t.layer1.0.bn1.weight       |      (64,)             |              |
|      net_t.layer1.0.bn1.bias         |      (64,)             |              |
|     net_t.layer1.0.conv2             |     36.864K            |     0.151G   |
|      net_t.layer1.0.conv2.weight     |      (64, 64, 3, 3)    |              |
|     net_t.layer1.0.bn2               |     0.128K             |     0.524M   |
|      net_t.layer1.0.bn2.weight       |      (64,)             |              |
|      net_t.layer1.0.bn2.bias         |      (64,)             |              |
|    net_t.layer1.1                    |    73.984K             |    0.303G    |
|     net_t.layer1.1.conv1             |     36.864K            |     0.151G   |
|      net_t.layer1.1.conv1.weight     |      (64, 64, 3, 3)    |              |
|     net_t.layer1.1.bn1               |     0.128K             |     0.524M   |
|      net_t.layer1.1.bn1.weight       |      (64,)             |              |
|      net_t.layer1.1.bn1.bias         |      (64,)             |              |
|     net_t.layer1.1.conv2             |     36.864K            |     0.151G   |
|      net_t.layer1.1.conv2.weight     |      (64, 64, 3, 3)    |              |
|     net_t.layer1.1.bn2               |     0.128K             |     0.524M   |
|      net_t.layer1.1.bn2.weight       |      (64,)             |              |
|      net_t.layer1.1.bn2.bias         |      (64,)             |              |
|   net_t.layer2                       |   0.526M               |   0.538G     |
|    net_t.layer2.0                    |    0.23M               |    0.236G    |
|     net_t.layer2.0.conv1             |     73.728K            |     75.497M  |
|      net_t.layer2.0.conv1.weight     |      (128, 64, 3, 3)   |              |
|     net_t.layer2.0.bn1               |     0.256K             |     0.262M   |
|      net_t.layer2.0.bn1.weight       |      (128,)            |              |
|      net_t.layer2.0.bn1.bias         |      (128,)            |              |
|     net_t.layer2.0.conv2             |     0.147M             |     0.151G   |
|      net_t.layer2.0.conv2.weight     |      (128, 128, 3, 3)  |              |
|     net_t.layer2.0.bn2               |     0.256K             |     0.262M   |
|      net_t.layer2.0.bn2.weight       |      (128,)            |              |
|      net_t.layer2.0.bn2.bias         |      (128,)            |              |
|     net_t.layer2.0.downsample        |     8.448K             |     8.651M   |
|      net_t.layer2.0.downsample.0     |      8.192K            |      8.389M  |
|      net_t.layer2.0.downsample.1     |      0.256K            |      0.262M  |
|    net_t.layer2.1                    |    0.295M              |    0.303G    |
|     net_t.layer2.1.conv1             |     0.147M             |     0.151G   |
|      net_t.layer2.1.conv1.weight     |      (128, 128, 3, 3)  |              |
|     net_t.layer2.1.bn1               |     0.256K             |     0.262M   |
|      net_t.layer2.1.bn1.weight       |      (128,)            |              |
|      net_t.layer2.1.bn1.bias         |      (128,)            |              |
|     net_t.layer2.1.conv2             |     0.147M             |     0.151G   |
|      net_t.layer2.1.conv2.weight     |      (128, 128, 3, 3)  |              |
|     net_t.layer2.1.bn2               |     0.256K             |     0.262M   |
|      net_t.layer2.1.bn2.weight       |      (128,)            |              |
|      net_t.layer2.1.bn2.bias         |      (128,)            |              |
|   net_t.layer3                       |   2.1M                 |   0.538G     |
|    net_t.layer3.0                    |    0.919M              |    0.235G    |
|     net_t.layer3.0.conv1             |     0.295M             |     75.497M  |
|      net_t.layer3.0.conv1.weight     |      (256, 128, 3, 3)  |              |
|     net_t.layer3.0.bn1               |     0.512K             |     0.131M   |
|      net_t.layer3.0.bn1.weight       |      (256,)            |              |
|      net_t.layer3.0.bn1.bias         |      (256,)            |              |
|     net_t.layer3.0.conv2             |     0.59M              |     0.151G   |
|      net_t.layer3.0.conv2.weight     |      (256, 256, 3, 3)  |              |
|     net_t.layer3.0.bn2               |     0.512K             |     0.131M   |
|      net_t.layer3.0.bn2.weight       |      (256,)            |              |
|      net_t.layer3.0.bn2.bias         |      (256,)            |              |
|     net_t.layer3.0.downsample        |     33.28K             |     8.52M    |
|      net_t.layer3.0.downsample.0     |      32.768K           |      8.389M  |
|      net_t.layer3.0.downsample.1     |      0.512K            |      0.131M  |
|    net_t.layer3.1                    |    1.181M              |    0.302G    |
|     net_t.layer3.1.conv1             |     0.59M              |     0.151G   |
|      net_t.layer3.1.conv1.weight     |      (256, 256, 3, 3)  |              |
|     net_t.layer3.1.bn1               |     0.512K             |     0.131M   |
|      net_t.layer3.1.bn1.weight       |      (256,)            |              |
|      net_t.layer3.1.bn1.bias         |      (256,)            |              |
|     net_t.layer3.1.conv2             |     0.59M              |     0.151G   |
|      net_t.layer3.1.conv2.weight     |      (256, 256, 3, 3)  |              |
|     net_t.layer3.1.bn2               |     0.512K             |     0.131M   |
|      net_t.layer3.1.bn2.weight       |      (256,)            |              |
|      net_t.layer3.1.bn2.bias         |      (256,)            |              |
|  mff_oce                             |  16.401M               |  2.468G      |
|   mff_oce.bn_layer                   |   15.736M              |   2.014G     |
|    mff_oce.bn_layer.0                |    6.295M              |    0.806G    |
|     mff_oce.bn_layer.0.conv1         |     3.539M             |     0.453G   |
|      mff_oce.bn_layer.0.conv1.weight |      (512, 768, 3, 3)  |              |
|     mff_oce.bn_layer.0.bn1           |     1.024K             |     0.131M   |
|      mff_oce.bn_layer.0.bn1.weight   |      (512,)            |              |
|      mff_oce.bn_layer.0.bn1.bias     |      (512,)            |              |
|     mff_oce.bn_layer.0.conv2         |     2.359M             |     0.302G   |
|      mff_oce.bn_layer.0.conv2.weight |      (512, 512, 3, 3)  |              |
|     mff_oce.bn_layer.0.bn2           |     1.024K             |     0.131M   |
|      mff_oce.bn_layer.0.bn2.weight   |      (512,)            |              |
|      mff_oce.bn_layer.0.bn2.bias     |      (512,)            |              |
|     mff_oce.bn_layer.0.downsample    |     0.394M             |     50.463M  |
|      mff_oce.bn_layer.0.downsample.0 |      0.393M            |      50.332M |
|      mff_oce.bn_layer.0.downsample.1 |      1.024K            |      0.131M  |
|    mff_oce.bn_layer.1                |    4.721M              |    0.604G    |
|     mff_oce.bn_layer.1.conv1         |     2.359M             |     0.302G   |
|      mff_oce.bn_layer.1.conv1.weight |      (512, 512, 3, 3)  |              |
|     mff_oce.bn_layer.1.bn1           |     1.024K             |     0.131M   |
|      mff_oce.bn_layer.1.bn1.weight   |      (512,)            |              |
|      mff_oce.bn_layer.1.bn1.bias     |      (512,)            |              |
|     mff_oce.bn_layer.1.conv2         |     2.359M             |     0.302G   |
|      mff_oce.bn_layer.1.conv2.weight |      (512, 512, 3, 3)  |              |
|     mff_oce.bn_layer.1.bn2           |     1.024K             |     0.131M   |
|      mff_oce.bn_layer.1.bn2.weight   |      (512,)            |              |
|      mff_oce.bn_layer.1.bn2.bias     |      (512,)            |              |
|    mff_oce.bn_layer.2                |    4.721M              |    0.604G    |
|     mff_oce.bn_layer.2.conv1         |     2.359M             |     0.302G   |
|      mff_oce.bn_layer.2.conv1.weight |      (512, 512, 3, 3)  |              |
|     mff_oce.bn_layer.2.bn1           |     1.024K             |     0.131M   |
|      mff_oce.bn_layer.2.bn1.weight   |      (512,)            |              |
|      mff_oce.bn_layer.2.bn1.bias     |      (512,)            |              |
|     mff_oce.bn_layer.2.conv2         |     2.359M             |     0.302G   |
|      mff_oce.bn_layer.2.conv2.weight |      (512, 512, 3, 3)  |              |
|     mff_oce.bn_layer.2.bn2           |     1.024K             |     0.131M   |
|      mff_oce.bn_layer.2.bn2.weight   |      (512,)            |              |
|      mff_oce.bn_layer.2.bn2.bias     |      (512,)            |              |
|   mff_oce.conv1                      |   73.728K              |   0.151G     |
|    mff_oce.conv1.weight              |    (128, 64, 3, 3)     |              |
|   mff_oce.bn1                        |   0.256K               |   0.524M     |
|    mff_oce.bn1.weight                |    (128,)              |              |
|    mff_oce.bn1.bias                  |    (128,)              |              |
|   mff_oce.conv2                      |   0.295M               |   0.151G     |
|    mff_oce.conv2.weight              |    (256, 128, 3, 3)    |              |
|   mff_oce.bn2                        |   0.512K               |   0.262M     |
|    mff_oce.bn2.weight                |    (256,)              |              |
|    mff_oce.bn2.bias                  |    (256,)              |              |
|   mff_oce.conv3                      |   0.295M               |   0.151G     |
|    mff_oce.conv3.weight              |    (256, 128, 3, 3)    |              |
|   mff_oce.bn3                        |   0.512K               |   0.262M     |
|    mff_oce.bn3.weight                |    (256,)              |              |
|    mff_oce.bn3.bias                  |    (256,)              |              |
|  net_s                               |  3.703M                |  1.565G      |
|   net_s.layer1                       |   2.821M               |   0.521G     |
|    net_s.layer1.0                    |    1.64M               |    0.218G    |
|     net_s.layer1.0.conv1             |     0.524M             |     33.554M  |
|      net_s.layer1.0.conv1.weight     |      (512, 256, 2, 2)  |              |
|     net_s.layer1.0.bn1               |     0.512K             |     0.131M   |
|      net_s.layer1.0.bn1.weight       |      (256,)            |              |
|      net_s.layer1.0.bn1.bias         |      (256,)            |              |
|     net_s.layer1.0.conv2             |     0.59M              |     0.151G   |
|      net_s.layer1.0.conv2.weight     |      (256, 256, 3, 3)  |              |
|     net_s.layer1.0.bn2               |     0.512K             |     0.131M   |
|      net_s.layer1.0.bn2.weight       |      (256,)            |              |
|      net_s.layer1.0.bn2.bias         |      (256,)            |              |
|     net_s.layer1.0.upsample          |     0.525M             |     33.686M  |
|      net_s.layer1.0.upsample.0       |      0.524M            |      33.554M |
|      net_s.layer1.0.upsample.1       |      0.512K            |      0.131M  |
|    net_s.layer1.1                    |    1.181M              |    0.302G    |
|     net_s.layer1.1.conv1             |     0.59M              |     0.151G   |
|      net_s.layer1.1.conv1.weight     |      (256, 256, 3, 3)  |              |
|     net_s.layer1.1.bn1               |     0.512K             |     0.131M   |
|      net_s.layer1.1.bn1.weight       |      (256,)            |              |
|      net_s.layer1.1.bn1.bias         |      (256,)            |              |
|     net_s.layer1.1.conv2             |     0.59M              |     0.151G   |
|      net_s.layer1.1.conv2.weight     |      (256, 256, 3, 3)  |              |
|     net_s.layer1.1.bn2               |     0.512K             |     0.131M   |
|      net_s.layer1.1.bn2.weight       |      (256,)            |              |
|      net_s.layer1.1.bn2.bias         |      (256,)            |              |
|   net_s.layer2                       |   0.706M               |   0.521G     |
|    net_s.layer2.0                    |    0.41M               |    0.219G    |
|     net_s.layer2.0.conv1             |     0.131M             |     33.554M  |
|      net_s.layer2.0.conv1.weight     |      (256, 128, 2, 2)  |              |
|     net_s.layer2.0.bn1               |     0.256K             |     0.262M   |
|      net_s.layer2.0.bn1.weight       |      (128,)            |              |
|      net_s.layer2.0.bn1.bias         |      (128,)            |              |
|     net_s.layer2.0.conv2             |     0.147M             |     0.151G   |
|      net_s.layer2.0.conv2.weight     |      (128, 128, 3, 3)  |              |
|     net_s.layer2.0.bn2               |     0.256K             |     0.262M   |
|      net_s.layer2.0.bn2.weight       |      (128,)            |              |
|      net_s.layer2.0.bn2.bias         |      (128,)            |              |
|     net_s.layer2.0.upsample          |     0.131M             |     33.817M  |
|      net_s.layer2.0.upsample.0       |      0.131M            |      33.554M |
|      net_s.layer2.0.upsample.1       |      0.256K            |      0.262M  |
|    net_s.layer2.1                    |    0.295M              |    0.303G    |
|     net_s.layer2.1.conv1             |     0.147M             |     0.151G   |
|      net_s.layer2.1.conv1.weight     |      (128, 128, 3, 3)  |              |
|     net_s.layer2.1.bn1               |     0.256K             |     0.262M   |
|      net_s.layer2.1.bn1.weight       |      (128,)            |              |
|      net_s.layer2.1.bn1.bias         |      (128,)            |              |
|     net_s.layer2.1.conv2             |     0.147M             |     0.151G   |
|      net_s.layer2.1.conv2.weight     |      (128, 128, 3, 3)  |              |
|     net_s.layer2.1.bn2               |     0.256K             |     0.262M   |
|      net_s.layer2.1.bn2.weight       |      (128,)            |              |
|      net_s.layer2.1.bn2.bias         |      (128,)            |              |
|   net_s.layer3                       |   0.177M               |   0.523G     |
|    net_s.layer3.0                    |    0.103M              |    0.22G     |
|     net_s.layer3.0.conv1             |     32.768K            |     33.554M  |
|      net_s.layer3.0.conv1.weight     |      (128, 64, 2, 2)   |              |
|     net_s.layer3.0.bn1               |     0.128K             |     0.524M   |
|      net_s.layer3.0.bn1.weight       |      (64,)             |              |
|      net_s.layer3.0.bn1.bias         |      (64,)             |              |
|     net_s.layer3.0.conv2             |     36.864K            |     0.151G   |
|      net_s.layer3.0.conv2.weight     |      (64, 64, 3, 3)    |              |
|     net_s.layer3.0.bn2               |     0.128K             |     0.524M   |
|      net_s.layer3.0.bn2.weight       |      (64,)             |              |
|      net_s.layer3.0.bn2.bias         |      (64,)             |              |
|     net_s.layer3.0.upsample          |     32.896K            |     34.079M  |
|      net_s.layer3.0.upsample.0       |      32.768K           |      33.554M |
|      net_s.layer3.0.upsample.1       |      0.128K            |      0.524M  |
|    net_s.layer3.1                    |    73.984K             |    0.303G    |
|     net_s.layer3.1.conv1             |     36.864K            |     0.151G   |
|      net_s.layer3.1.conv1.weight     |      (64, 64, 3, 3)    |              |
|     net_s.layer3.1.bn1               |     0.128K             |     0.524M   |
|      net_s.layer3.1.bn1.weight       |      (64,)             |              |
|      net_s.layer3.1.bn1.bias         |      (64,)             |              |
|     net_s.layer3.1.conv2             |     36.864K            |     0.151G   |
|      net_s.layer3.1.conv2.weight     |      (64, 64, 3, 3)    |              |
|     net_s.layer3.1.bn2               |     0.128K             |     0.524M   |
|      net_s.layer3.1.bn2.weight       |      (64,)             |              |
|      net_s.layer3.1.bn2.bias         |      (64,)             |              |
|  contrastive_head.0                  |  4.194M                |  4.194M      |
|   contrastive_head.0.weight          |   (128, 32768)         |              |
|   contrastive_head.0.bias            |   (128,)               |              |
----------------------------------------------------------------------------
2025-02-19 17:01:54,407 - ==> Creating optimizer
2025-02-19 17:01:54,408 - ==> Loading dataset: RealIAD
